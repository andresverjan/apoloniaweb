<mat-card-actions
  fxLayout="row"
  fxLayoutAlign="end center"
  style="margin-right: 10px"
>
  <button
    mat-raised-button
    fxLayout="row"
    fxLayout.xs="column"
    fxLayoutAlign="center"
    fxFlex="22"
    (click)="onClickAdicionar()"
    color="primary"
    *ngIf="showListado"
  >
    <mat-icon>add_circle_outline</mat-icon>
    Adicion
  </button>
</mat-card-actions>

<div>
  <mat-card fxFill>
    <mat-card-title fxLayoutAlign="center">
      <label>BUSCAR</label>
    </mat-card-title>
    <mat-card-content fxLayout="column" fxLayoutAlign="center">
      <div fxLayout="row" fxFlex fxLayoutAlign="space-between center">
        <mat-icon matPrefix>search</mat-icon>
        <mat-form-field fxFlex="100">
          <input
            matInput
            id="filterbyFactura"
            placeholder="Buscar por factura"
            [(ngModel)]="filter.T17Factura"
            (keyup)="findBy()"
          />
        </mat-form-field>
        <mat-form-field fxFlex="100">
          <mat-label>Buscar por fecha de inicio</mat-label>
          <input
            matInput
            [matDatepicker]="picker1"
            (dateChange)="onDateChangeInicial($event)"
            [value]="filter['T17FechaIni']"
            readonly
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="picker1"
          ></mat-datepicker-toggle>
          <mat-datepicker #picker1></mat-datepicker>
        </mat-form-field>
        <mat-form-field fxFlex="100">
          <mat-label>Buscar por fecha final</mat-label>
          <input
            matInput
            [matDatepicker]="picker2"
            (dateChange)="onDateChangeFinal($event)"
            [value]="filter['T17FechaFin']"
            readonly
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="picker2"
          ></mat-datepicker-toggle>
          <mat-datepicker #picker2></mat-datepicker>
        </mat-form-field>
      </div>
    </mat-card-content>
  </mat-card>
</div>
<br />

<mat-progress-bar mode="indeterminate" *ngIf="IsWaiting"></mat-progress-bar>

<mat-paginator
  [length]="totalRegistros"
  [pageSize]="pageSize"
  [pageSizeOptions]="pageSizeOptions"
  (page)="handlePageChange($event)"
>
</mat-paginator>

<div class="container" *ngIf="showListado" style="overflow: hidden">
  <mat-grid-list cols="5" rowHeight="230px">
    <mat-grid-tile *ngFor="let egreso of egresos" style="overflow-x: hidden">
      <mat-card (click)="verDetalle(egreso)" class="dashboard-card">
        <mat-card-content class="dashboard-card-content">
          <mat-icon>attach_money</mat-icon>

          <h5 class="cssRow">{{ egreso.T17Factura }}</h5>
          <div>{{ egreso.T17Proveedor }}</div>
          <div>{{ egreso.T17Fecha }}</div>
          <div>{{ egreso.T17Valor }}</div>
          <div>{{ egreso.T17Observacion }}</div>
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>
  </mat-grid-list>
</div>

<div class="container" *ngIf="!showListado" style="overflow: hidden">
  <mat-card-content class="window-dashboard-card-content contentprincipal">
    <mat-toolbar color="primary">
      <mat-icon matPrefix>account_balance</mat-icon>
      <label>Configuraci√≥n de Egresos - [Adicionar - Actualizar]</label>
      <span class="example-spacer"></span>
      <button
        mat-icon-button
        class="example-icon"
        aria-label="Example icon-button with share icon"
        (click)="cancelar()"
      >
        <mat-icon>close</mat-icon>
      </button>
    </mat-toolbar>

    <mat-card-header>
      <mat-card-title> </mat-card-title>
    </mat-card-header>
    <mat-card class="cardcontent">
      <mat-card-content fxLayout="column" fxLayoutAlign="center">
        <div fxLayout="column" fxLayoutAlign="space-between " fxFlex="100">
          <form [formGroup]="egresoForm" autocomplete="off" novalidate>
            <mat-card class="cardcontent">
              <mat-card-title fxLayoutAlign="center">
                <label>Datos de {{ etiquetaNombreModulo }}</label>
              </mat-card-title>
              <mat-card-content fxLayout="column" fxLayoutAlign="center">
                <div fxLayout="row" fxFlex fxLayoutAlign="space-between center">
                  <mat-form-field fxFlex>
                    <mat-icon matPrefix>note</mat-icon>
                    <input
                      matInput
                      formControlName="T17Factura"
                      id="T17Factura"
                      placeholder="Numero de Factura"
                    />
                  </mat-form-field>

                  <mat-form-field fxFlex>
                    <mat-icon matPrefix>edit</mat-icon>
                    <input
                      matInput
                      formControlName="T17Soporte"
                      id="T17Soporte"
                      placeholder="Numero de Soporte"
                    />
                  </mat-form-field>
                </div>

                <div fxLayout="row" fxFlex fxLayoutAlign="space-between center">
                  <div fxLayout="row" fxLayoutAlign="center" fxFlex="50">
                    <app-buscadormodal
                      [filters]="['Nombre', 'Nit']"
                      (selected)="onPorveedorSelected($event)"
                      [columnas]="{
                        Nombre: 'Nombre Proveedor',
                        Nit: 'Nit Proveedor'
                      }"
                      [resultInputText]="['Nombre']"
                      [service]="proveedoresService"
                      tituloBusqueda="Proveedores"
                      [defaultObjValue]="
                        egresoForm.controls['T17Proveedor'].value
                      "
                      fxFlex="60"
                      [readonly]="false"
                    ></app-buscadormodal>
                  </div>
                  <mat-form-field fxFlex>
                    <mat-icon matPrefix>edit</mat-icon>
                    <input
                      matInput
                      formControlName="T17Fecha"
                      id="T17Fecha"
                      placeholder="Fecha del documento"
                    />
                  </mat-form-field>
                </div>
                <div fxLayout="row" fxFlex fxLayoutAlign="space-between center">
                  <div fxLayout="row" fxLayoutAlign="center" fxFlex="50">
                    <app-select
                      label="Forma de Pago"
                      [data]="formasPagos"
                      icono="attach_money"
                      fxFlex
                      (valSelected)="onFormaPagoSelected($event)"
                    ></app-select>
                  </div>

                  <mat-form-field fxFlex>
                    <mat-icon matPrefix>edit</mat-icon>
                    <input
                      matInput
                      formControlName="T17Valor"
                      matTooltip="Presione enter para guardar el valor"
                      matTooltipPosition="right"
                      (change)="calculateTotal()"
                      id="T17Valor"
                      placeholder="Valor"
                    />
                  </mat-form-field>
                </div>
                <div fxLayout="row" fxFlex fxLayoutAlign="space-between center">
                  <mat-form-field fxFlex>
                    <mat-icon matPrefix>edit</mat-icon>
                    <input
                      matInput
                      formControlName="T17Dctos"
                      matTooltip="Presione enter para guardar el valor"
                      matTooltipPosition="right"
                      id="T17Dctos"
                      (change)="calculateTotal()"
                      placeholder="% Descuento"
                    />
                  </mat-form-field>
                  <mat-form-field fxFlex>
                    <mat-icon matPrefix>edit</mat-icon>
                    <input
                      matInput
                      formControlName="T17ICA"
                      id="T17ICA"
                      placeholder="ICA"
                      readonly
                    />
                  </mat-form-field>
                </div>
                <div fxLayout="row" fxFlex fxLayoutAlign="space-between center">
                  <mat-form-field fxFlex>
                    <mat-icon matPrefix>edit</mat-icon>
                    <input
                      matInput
                      formControlName="T17IVA"
                      id="T17IVA"
                      placeholder="IVA"
                      readonly
                    />
                  </mat-form-field>
                  <mat-form-field fxFlex>
                    <mat-icon matPrefix>edit</mat-icon>
                    <input
                      matInput
                      formControlName="T17RF"
                      id="T17RF"
                      placeholder="RF"
                      readonly
                    />
                  </mat-form-field>
                </div>
                <div fxLayout="row" fxFlex fxLayoutAlign="space-between center">
                  <mat-form-field fxFlex>
                    <mat-icon matPrefix>edit</mat-icon>
                    <input
                      matInput
                      formControlName="T17Total"
                      id="T17Total"
                      placeholder="Total"
                      readonly
                    />
                  </mat-form-field>
                  <mat-form-field fxFlex>
                    <mat-icon matPrefix>edit</mat-icon>
                    <input
                      matInput
                      formControlName="T17Observacion"
                      id="T17Observacion"
                      placeholder="Observaciones"
                    />
                  </mat-form-field>
                </div>
              </mat-card-content>
            </mat-card>
          </form>
        </div>
      </mat-card-content>
      <mat-card-actions fxLayout="row" fxLayoutAlign="center center">
        <button
          mat-raised-button
          color="primary"
          fxLayout="row"
          fxLayout.xs="column"
          fxLayoutAlign="center"
          (click)="guardar()"
          fxFlex
          [disabled]="!egresoForm.valid"
          *ngIf="showBtnAdicionar"
        >
          <mat-icon>add_task</mat-icon>
          {{ isUpdating ? "Actualizar" : "Adicionar" }}
        </button>
        <button
          color="primary"
          mat-raised-button
          (click)="actualizar()"
          fxLayout="row"
          fxLayout.xs="column"
          fxLayoutAlign="center"
          fxFlex
          [disabled]="!egresoForm.valid"
          *ngIf="showBtnActualizar"
        >
          <mat-icon>loop</mat-icon>
          Actualizar
        </button>
        <button
          mat-raised-button
          (click)="eliminar()"
          fxLayout="row"
          fxLayout.xs="column"
          fxLayoutAlign="center"
          fxFlex
          *ngIf="showBtnEliminar"
        >
          <mat-icon>delete</mat-icon>
          Eliminar
        </button>
        <button
          mat-raised-button
          color="warn"
          (click)="cancelar()"
          fxLayout="row"
          fxLayout.xs="column"
          fxLayoutAlign="center"
          fxFlex
        >
          <mat-icon>cancel</mat-icon>
          Cancelar
        </button>
      </mat-card-actions>
    </mat-card>
  </mat-card-content>
</div>
